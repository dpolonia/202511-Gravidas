# Gravidas Pipeline v1.2.0 - Implementation Guide (Part 2)

**This is Part 2 of the implementation guide. See V1.2.0_IMPLEMENTATION_GUIDE.md for Part 1 (Phase 1).**

---

## Phase 2: Enhanced Capabilities (Weeks 5-8)

### 2.1 Multiple Interview Protocols ðŸŸ¡ P1 HIGH

**Current State:** 1 protocol (prenatal_care.json)
**Target State:** 5 diverse protocols
**Priority:** P1 (Research Versatility)
**Effort:** 30 hours

#### Objective
Create 4 additional interview protocols covering different maternal healthcare scenarios, enabling the pipeline to generate diverse interview types for broader research applications.

#### Implementation Steps (Claude Code)

##### Step 2.1.1: Analyze Existing Protocol Structure
**Claude Code Instructions:**
1. Read existing protocol:
```bash
# Examine current protocol structure
cat Script/interview_protocols/prenatal_care.json
```

2. Document protocol schema:
```json
{
  "protocol_name": "prenatal_care",
  "description": "Comprehensive prenatal care interview",
  "target_population": "Pregnant women in any trimester",
  "estimated_duration_minutes": 15-20,
  "questions": [
    {
      "id": 1,
      "section": "introduction",
      "question": "Can you tell me about your current pregnancy?",
      "follow_ups": [...],
      "clinical_focus": ["pregnancy_timeline", "current_status"]
    },
    // ... more questions
  ]
}
```

##### Step 2.1.2: Create Protocol 2 - Postpartum Care Interview
**File:** `Script/interview_protocols/postpartum_care.json`

**Claude Code Instructions:**
Create comprehensive postpartum interview protocol (15 questions):

```json
{
  "protocol_name": "postpartum_care",
  "description": "Postpartum care and recovery interview",
  "version": "1.0",
  "target_population": "Women 0-6 weeks postpartum",
  "estimated_duration_minutes": 18,
  "clinical_focus_areas": [
    "physical_recovery",
    "mental_health",
    "infant_care",
    "breastfeeding",
    "contraception",
    "support_systems"
  ],
  "questions": [
    {
      "id": 1,
      "section": "introduction",
      "question": "How many weeks postpartum are you, and how has your recovery been going?",
      "follow_ups": [
        "What type of delivery did you have?",
        "Did you experience any complications during delivery?"
      ],
      "clinical_focus": ["postpartum_timeline", "delivery_method", "complications"]
    },
    {
      "id": 2,
      "section": "physical_recovery",
      "question": "How are you feeling physically since giving birth?",
      "follow_ups": [
        "Are you experiencing any pain or discomfort?",
        "Have you had your postpartum checkup yet?",
        "Were you given any specific care instructions?"
      ],
      "clinical_focus": ["physical_symptoms", "healing_progress", "medical_follow_up"]
    },
    {
      "id": 3,
      "section": "mental_health",
      "question": "How would you describe your mood and emotional state since the baby was born?",
      "follow_ups": [
        "Have you experienced any feelings of sadness or anxiety?",
        "Do you have someone you can talk to about your feelings?",
        "Were you screened for postpartum depression?"
      ],
      "clinical_focus": ["mental_health", "postpartum_depression", "emotional_support"]
    },
    {
      "id": 4,
      "section": "infant_feeding",
      "question": "How are you feeding your baby?",
      "follow_ups": [
        "If breastfeeding: How is breastfeeding going for you?",
        "Have you encountered any challenges with feeding?",
        "Did you receive lactation support?",
        "If formula feeding: What led you to choose formula?"
      ],
      "clinical_focus": ["feeding_method", "breastfeeding_challenges", "lactation_support"]
    },
    {
      "id": 5,
      "section": "infant_care",
      "question": "How are you managing with infant care overall?",
      "follow_ups": [
        "Do you feel confident in caring for your baby?",
        "What has been most challenging?",
        "Who helps you with the baby?"
      ],
      "clinical_focus": ["parenting_confidence", "challenges", "support_network"]
    },
    {
      "id": 6,
      "section": "sleep",
      "question": "How much sleep are you getting?",
      "follow_ups": [
        "Is your baby sleeping for stretches?",
        "How are you coping with sleep deprivation?",
        "Do you have help at night?"
      ],
      "clinical_focus": ["sleep_deprivation", "fatigue", "night_support"]
    },
    {
      "id": 7,
      "section": "partner_relationship",
      "question": "How is your relationship with your partner since the baby arrived?",
      "follow_ups": [
        "Is your partner involved in baby care?",
        "Have you discussed division of responsibilities?",
        "Any challenges in your relationship?"
      ],
      "clinical_focus": ["partner_support", "relationship_strain", "shared_responsibilities"]
    },
    {
      "id": 8,
      "section": "support_systems",
      "question": "What kind of support do you have at home?",
      "follow_ups": [
        "Do family or friends help out?",
        "Do you feel you have enough support?",
        "Are there community resources you're using?"
      ],
      "clinical_focus": ["social_support", "family_assistance", "community_resources"]
    },
    {
      "id": 9,
      "section": "pain_and_healing",
      "question": "Have you experienced any complications or concerns with healing?",
      "follow_ups": [
        "Any issues with stitches or incisions?",
        "Excessive bleeding or unusual discharge?",
        "Did you contact your provider about any concerns?"
      ],
      "clinical_focus": ["healing_complications", "infection_signs", "medical_contact"]
    },
    {
      "id": 10,
      "section": "contraception",
      "question": "Have you discussed contraception and family planning with your provider?",
      "follow_ups": [
        "What method are you considering or using?",
        "When do you plan to start contraception?",
        "Any concerns about available options?"
      ],
      "clinical_focus": ["family_planning", "contraception_method", "future_pregnancy"]
    },
    {
      "id": 11,
      "section": "returning_to_work",
      "question": "What are your plans regarding returning to work?",
      "follow_ups": [
        "How long is your leave?",
        "How do you feel about returning to work?",
        "Do you have childcare arranged?"
      ],
      "clinical_focus": ["work_return", "leave_duration", "childcare_planning"]
    },
    {
      "id": 12,
      "section": "self_care",
      "question": "Have you been able to take any time for yourself?",
      "follow_ups": [
        "What self-care activities do you do?",
        "Do you feel guilty taking time for yourself?",
        "What barriers prevent self-care?"
      ],
      "clinical_focus": ["self_care", "maternal_wellbeing", "guilt"]
    },
    {
      "id": 13,
      "section": "expectations_vs_reality",
      "question": "How does your postpartum experience compare to what you expected?",
      "follow_ups": [
        "What surprised you most?",
        "What do you wish you had known beforehand?",
        "What resources would have been helpful?"
      ],
      "clinical_focus": ["expectations", "preparedness", "education_needs"]
    },
    {
      "id": 14,
      "section": "medical_follow_up",
      "question": "Have you attended your postpartum checkup?",
      "follow_ups": [
        "When is it scheduled?",
        "What topics do you want to discuss?",
        "Any concerns you plan to raise?"
      ],
      "clinical_focus": ["postpartum_visit", "medical_concerns", "provider_communication"]
    },
    {
      "id": 15,
      "section": "closing",
      "question": "Is there anything else about your postpartum experience you'd like to share?",
      "follow_ups": [
        "What advice would you give to other new mothers?",
        "What support would be most helpful right now?"
      ],
      "clinical_focus": ["additional_concerns", "advice", "unmet_needs"]
    }
  ],
  "metadata": {
    "created_date": "2025-01-15",
    "created_by": "Claude Code - Gravidas v1.2.0",
    "validated_by": null,
    "clinical_review_status": "pending"
  }
}
```

##### Step 2.1.3: Create Protocol 3 - High-Risk Pregnancy Interview
**File:** `Script/interview_protocols/high_risk_pregnancy.json`

**Claude Code Instructions:**
Create protocol focused on high-risk pregnancy management (18 questions):

```json
{
  "protocol_name": "high_risk_pregnancy",
  "description": "High-risk pregnancy monitoring and management interview",
  "version": "1.0",
  "target_population": "Pregnant women with high-risk conditions or complications",
  "estimated_duration_minutes": 22,
  "clinical_focus_areas": [
    "risk_factors",
    "specialized_care",
    "monitoring_compliance",
    "anxiety_management",
    "complications",
    "multidisciplinary_care"
  ],
  "questions": [
    {
      "id": 1,
      "section": "introduction",
      "question": "Can you tell me about your pregnancy and what makes it high-risk?",
      "follow_ups": [
        "What specific conditions or factors contribute to the high-risk classification?",
        "When were you told your pregnancy was high-risk?",
        "How did you feel when you learned this?"
      ],
      "clinical_focus": ["risk_factors", "diagnosis_timeline", "emotional_response"]
    },
    {
      "id": 2,
      "section": "medical_history",
      "question": "What existing medical conditions do you have?",
      "follow_ups": [
        "How are these conditions being managed during pregnancy?",
        "Have your medications changed since becoming pregnant?",
        "Are you seeing specialists for these conditions?"
      ],
      "clinical_focus": ["chronic_conditions", "medication_management", "specialist_care"]
    },
    {
      "id": 3,
      "section": "pregnancy_complications",
      "question": "Have you experienced any complications during this pregnancy?",
      "follow_ups": [
        "What complications have you had?",
        "How were they treated?",
        "Are you currently being monitored for any specific concerns?"
      ],
      "clinical_focus": ["complications", "treatment", "ongoing_monitoring"]
    },
    {
      "id": 4,
      "section": "specialized_care",
      "question": "What kind of specialized prenatal care are you receiving?",
      "follow_ups": [
        "How often do you have appointments?",
        "Which specialists are you seeing?",
        "Is there a maternal-fetal medicine specialist involved?",
        "Do you attend a high-risk pregnancy clinic?"
      ],
      "clinical_focus": ["specialist_types", "appointment_frequency", "MFM_involvement"]
    },
    {
      "id": 5,
      "section": "monitoring_and_testing",
      "question": "What types of monitoring or testing are you undergoing?",
      "follow_ups": [
        "How often do you have ultrasounds?",
        "Non-stress tests or other fetal monitoring?",
        "Blood pressure or glucose monitoring at home?",
        "Laboratory tests frequency?"
      ],
      "clinical_focus": ["testing_frequency", "fetal_monitoring", "home_monitoring"]
    },
    {
      "id": 6,
      "section": "medications",
      "question": "What medications are you currently taking?",
      "follow_ups": [
        "Any medications specifically for pregnancy complications?",
        "How do you manage multiple medications?",
        "Any side effects or concerns?",
        "Cost or access issues with medications?"
      ],
      "clinical_focus": ["medication_regimen", "adherence", "side_effects", "access"]
    },
    {
      "id": 7,
      "section": "lifestyle_modifications",
      "question": "Have you needed to make specific lifestyle changes due to the high-risk nature?",
      "follow_ups": [
        "Bed rest or activity restrictions?",
        "Dietary modifications?",
        "Work accommodations or leave?",
        "How challenging are these changes?"
      ],
      "clinical_focus": ["activity_restrictions", "diet", "work_modifications", "compliance_challenges"]
    },
    {
      "id": 8,
      "section": "emotional_wellbeing",
      "question": "How are you coping emotionally with having a high-risk pregnancy?",
      "follow_ups": [
        "What are your biggest worries or fears?",
        "Do you have anxiety about the baby's health?",
        "Are you receiving mental health support?",
        "How is this affecting your daily mood?"
      ],
      "clinical_focus": ["anxiety", "depression", "mental_health_support", "coping_mechanisms"]
    },
    {
      "id": 9,
      "section": "information_and_education",
      "question": "Do you feel you have enough information about your condition and risks?",
      "follow_ups": [
        "Has your care team explained things clearly?",
        "What questions do you still have?",
        "Where do you go for additional information?",
        "Do you understand warning signs to watch for?"
      ],
      "clinical_focus": ["patient_education", "health_literacy", "warning_signs", "information_sources"]
    },
    {
      "id": 10,
      "section": "support_system",
      "question": "What support do you have during this pregnancy?",
      "follow_ups": [
        "Is your partner/family supportive?",
        "Support groups for high-risk pregnancy?",
        "Help with practical matters (appointments, childcare, etc.)?",
        "Financial support or concerns?"
      ],
      "clinical_focus": ["social_support", "partner_involvement", "practical_assistance", "financial_stress"]
    },
    {
      "id": 11,
      "section": "previous_pregnancies",
      "question": "Have you had previous pregnancies? If so, how were they?",
      "follow_ups": [
        "Previous pregnancy complications?",
        "Live births, miscarriages, or losses?",
        "How does this pregnancy compare?",
        "Lessons learned from previous experiences?"
      ],
      "clinical_focus": ["obstetric_history", "previous_complications", "pregnancy_comparison"]
    },
    {
      "id": 12,
      "section": "care_coordination",
      "question": "How well coordinated is your care among different providers?",
      "follow_ups": [
        "Do your doctors communicate with each other?",
        "Do you repeat the same information to different providers?",
        "Any conflicting advice?",
        "Who coordinates your overall care?"
      ],
      "clinical_focus": ["care_coordination", "provider_communication", "care_integration"]
    },
    {
      "id": 13,
      "section": "hospitalization",
      "question": "Have you been hospitalized during this pregnancy?",
      "follow_ups": [
        "For what reason and how long?",
        "How was that experience?",
        "Are further hospitalizations anticipated?",
        "Concerns about potential hospitalization?"
      ],
      "clinical_focus": ["hospitalization_history", "inpatient_care", "hospital_experience"]
    },
    {
      "id": 14,
      "section": "delivery_planning",
      "question": "What is the plan for your delivery?",
      "follow_ups": [
        "Will you deliver early?",
        "Planned cesarean section?",
        "Where will you deliver (tertiary center, etc.)?",
        "Will there be a NICU team present?",
        "How do you feel about the delivery plan?"
      ],
      "clinical_focus": ["delivery_plan", "timing", "delivery_method", "facility_level", "neonatal_preparation"]
    },
    {
      "id": 15,
      "section": "treatment_adherence",
      "question": "How easy or difficult is it to follow all the recommendations?",
      "follow_ups": [
        "What makes it challenging?",
        "Missed appointments or tests?",
        "Medication adherence?",
        "What would help you follow the plan better?"
      ],
      "clinical_focus": ["adherence", "barriers", "missed_care", "support_needs"]
    },
    {
      "id": 16,
      "section": "work_and_daily_life",
      "question": "How is the high-risk pregnancy affecting your work and daily activities?",
      "follow_ups": [
        "Still working or on leave?",
        "Accommodations needed?",
        "Impact on household responsibilities?",
        "Financial impact of modified work?"
      ],
      "clinical_focus": ["employment_impact", "work_accommodations", "daily_functioning", "financial_burden"]
    },
    {
      "id": 17,
      "section": "future_pregnancy_considerations",
      "question": "Have you discussed future pregnancies with your provider?",
      "follow_ups": [
        "Would future pregnancies also be high-risk?",
        "Recommendations for spacing or prevention?",
        "How do you feel about having more children?",
        "Impact on family planning decisions?"
      ],
      "clinical_focus": ["future_pregnancy_risk", "family_planning", "contraception_counseling"]
    },
    {
      "id": 18,
      "section": "closing",
      "question": "What has been most helpful in managing your high-risk pregnancy?",
      "follow_ups": [
        "What would make things easier?",
        "Advice for others in similar situations?",
        "Anything else you'd like to share about your experience?"
      ],
      "clinical_focus": ["helpful_interventions", "unmet_needs", "patient_perspective"]
    }
  ],
  "metadata": {
    "created_date": "2025-01-15",
    "created_by": "Claude Code - Gravidas v1.2.0",
    "validated_by": null,
    "clinical_review_status": "pending"
  }
}
```

##### Step 2.1.4: Create Protocol 4 - Mental Health Screening
**File:** `Script/interview_protocols/mental_health_screening.json`

**Claude Code Instructions:**
Create sensitive mental health screening protocol (12 questions):

```json
{
  "protocol_name": "perinatal_mental_health",
  "description": "Perinatal mental health screening and support interview",
  "version": "1.0",
  "target_population": "Pregnant and postpartum women (up to 1 year postpartum)",
  "estimated_duration_minutes": 15,
  "content_warnings": ["depression", "anxiety", "suicidal_ideation", "trauma"],
  "clinical_focus_areas": [
    "depression_screening",
    "anxiety_assessment",
    "trauma_history",
    "support_systems",
    "coping_mechanisms",
    "treatment_access"
  ],
  "interviewer_notes": [
    "Use empathetic, non-judgmental tone",
    "Provide crisis resources if needed",
    "Ensure privacy and confidentiality",
    "Use validated screening language where possible"
  ],
  "questions": [
    {
      "id": 1,
      "section": "introduction",
      "question": "Thank you for taking the time to talk with me today about your emotional wellbeing. How are you feeling overall?",
      "follow_ups": [
        "What has your mood been like recently?",
        "Any changes in how you've been feeling emotionally?"
      ],
      "clinical_focus": ["general_mood", "emotional_state", "rapport_building"],
      "screening_tool": "General mood assessment"
    },
    {
      "id": 2,
      "section": "mood",
      "question": "Over the past two weeks, how often have you been bothered by feeling down, depressed, or hopeless?",
      "follow_ups": [
        "Not at all, several days, more than half the days, or nearly every day?",
        "When did you first notice these feelings?",
        "How severe would you say they are?"
      ],
      "clinical_focus": ["depression_symptoms", "frequency", "severity"],
      "screening_tool": "PHQ-2/PHQ-9 (depression)"
    },
    {
      "id": 3,
      "section": "anhedonia",
      "question": "Over the past two weeks, how often have you had little interest or pleasure in doing things?",
      "follow_ups": [
        "Not at all, several days, more than half the days, or nearly every day?",
        "What activities used to bring you joy?",
        "Have you lost interest in things you normally enjoy?"
      ],
      "clinical_focus": ["anhedonia", "interest_loss", "depression_screening"],
      "screening_tool": "PHQ-2/PHQ-9 (depression)"
    },
    {
      "id": 4,
      "section": "anxiety",
      "question": "How often have you been feeling nervous, anxious, or on edge?",
      "follow_ups": [
        "Not at all, several days, more than half the days, or nearly every day?",
        "What triggers your anxiety?",
        "Physical symptoms (heart racing, difficulty breathing, etc.)?"
      ],
      "clinical_focus": ["anxiety_symptoms", "triggers", "physical_manifestations"],
      "screening_tool": "GAD-2/GAD-7 (anxiety)"
    },
    {
      "id": 5,
      "section": "worry",
      "question": "How often have you been unable to stop or control worrying?",
      "follow_ups": [
        "What do you worry about most?",
        "How much does worry interfere with daily life?",
        "Worry about the baby specifically?"
      ],
      "clinical_focus": ["excessive_worry", "worry_content", "functional_impact"],
      "screening_tool": "GAD-2/GAD-7 (anxiety)"
    },
    {
      "id": 6,
      "section": "bonding",
      "question": "How would you describe your feelings toward your baby (or pregnancy)?",
      "follow_ups": [
        "Do you feel connected to your baby?",
        "Any difficulty bonding or feeling attached?",
        "Negative or scary thoughts about the baby?",
        "How guilty do these feelings make you?"
      ],
      "clinical_focus": ["maternal_infant_bonding", "attachment", "intrusive_thoughts"],
      "screening_tool": "Bonding assessment",
      "sensitivity": "high"
    },
    {
      "id": 7,
      "section": "intrusive_thoughts",
      "question": "Sometimes new mothers have unwanted or frightening thoughts about their baby. Have you experienced anything like this?",
      "follow_ups": [
        "What kind of thoughts?",
        "How often do they occur?",
        "Do you feel like you might act on these thoughts?",
        "How distressing are they?"
      ],
      "clinical_focus": ["intrusive_thoughts", "obsessions", "infanticide_risk"],
      "screening_tool": "OCD/intrusive thoughts screening",
      "sensitivity": "very_high",
      "crisis_assessment": true
    },
    {
      "id": 8,
      "section": "self_harm",
      "question": "Have you had any thoughts of harming yourself?",
      "follow_ups": [
        "How often?",
        "Do you have a plan?",
        "Have you taken any steps toward acting on these thoughts?",
        "What stops you from acting on them?"
      ],
      "clinical_focus": ["suicidal_ideation", "self_harm", "safety_planning"],
      "screening_tool": "Suicide risk assessment",
      "sensitivity": "very_high",
      "crisis_assessment": true,
      "safety_protocol": "If present, provide crisis resources immediately"
    },
    {
      "id": 9,
      "section": "sleep",
      "question": "How are you sleeping?",
      "follow_ups": [
        "Trouble falling asleep or staying asleep (apart from baby wake-ups)?",
        "Sleeping too much?",
        "How rested do you feel?",
        "Sleep impacting your functioning?"
      ],
      "clinical_focus": ["sleep_disturbance", "insomnia", "hypersomnia", "fatigue"]
    },
    {
      "id": 10,
      "section": "coping_and_support",
      "question": "What helps you cope when you're feeling down or anxious?",
      "follow_ups": [
        "Who do you talk to about your feelings?",
        "Do you have professional mental health support?",
        "What coping strategies work for you?",
        "Barriers to getting support?"
      ],
      "clinical_focus": ["coping_strategies", "social_support", "professional_help", "barriers_to_care"]
    },
    {
      "id": 11,
      "section": "treatment_history",
      "question": "Have you ever received treatment for depression, anxiety, or other mental health concerns?",
      "follow_ups": [
        "What kind of treatment (therapy, medication, both)?",
        "Was it helpful?",
        "Are you currently in treatment?",
        "If not, would you consider treatment now?"
      ],
      "clinical_focus": ["treatment_history", "current_treatment", "treatment_response", "willingness"]
    },
    {
      "id": 12,
      "section": "resources_and_closing",
      "question": "Would you be interested in information about mental health resources or support?",
      "follow_ups": [
        "What kind of support would be most helpful?",
        "Any barriers to accessing mental health care?",
        "Is there anything else you'd like to share about how you're feeling?"
      ],
      "clinical_focus": ["resource_needs", "access_barriers", "additional_concerns"],
      "closing": true
    }
  ],
  "crisis_resources": {
    "national_suicide_prevention_lifeline": "988",
    "crisis_text_line": "Text HOME to 741741",
    "postpartum_support_international": "1-800-944-4773",
    "emergency": "911"
  },
  "screening_tools_referenced": [
    "PHQ-2 (Patient Health Questionnaire-2)",
    "PHQ-9 (Patient Health Questionnaire-9)",
    "GAD-2 (Generalized Anxiety Disorder-2)",
    "GAD-7 (Generalized Anxiety Disorder-7)",
    "EPDS (Edinburgh Postnatal Depression Scale) - adapted"
  ],
  "metadata": {
    "created_date": "2025-01-15",
    "created_by": "Claude Code - Gravidas v1.2.0",
    "validated_by": null,
    "clinical_review_status": "pending",
    "requires_clinical_validation": true,
    "sensitivity_level": "very_high"
  }
}
```

##### Step 2.1.5: Create Protocol 5 - Genetic Counseling Interview
**File:** `Script/interview_protocols/genetic_counseling.json`

**Claude Code Instructions:**
Create genetic counseling and screening protocol (10 questions):

```json
{
  "protocol_name": "genetic_counseling",
  "description": "Prenatal genetic counseling and screening decision-making interview",
  "version": "1.0",
  "target_population": "Pregnant women considering or undergoing genetic testing",
  "estimated_duration_minutes": 12,
  "clinical_focus_areas": [
    "family_history",
    "genetic_risk_factors",
    "screening_decisions",
    "testing_understanding",
    "ethical_considerations",
    "decision_making_support"
  ],
  "questions": [
    {
      "id": 1,
      "section": "introduction",
      "question": "What brings you to genetic counseling today?",
      "follow_ups": [
        "Were you referred by your OB provider?",
        "Specific concerns about genetic conditions?",
        "What do you hope to learn from this conversation?"
      ],
      "clinical_focus": ["referral_reason", "patient_concerns", "expectations"]
    },
    {
      "id": 2,
      "section": "family_history",
      "question": "Can you tell me about your family medical history?",
      "follow_ups": [
        "Any genetic conditions in your family?",
        "Chromosomal abnormalities or birth defects?",
        "Intellectual disabilities or developmental delays?",
        "Recurrent pregnancy losses in family?"
      ],
      "clinical_focus": ["family_medical_history", "genetic_conditions", "inheritance_patterns"]
    },
    {
      "id": 3,
      "section": "ethnicity_and_background",
      "question": "What is your ethnic background?",
      "follow_ups": [
        "Partner's ethnic background?",
        "Consanguinity (related to partner)?",
        "Awareness of ethnicity-specific genetic risks?"
      ],
      "clinical_focus": ["ethnicity", "carrier_screening", "population_specific_risks"]
    },
    {
      "id": 4,
      "section": "obstetric_history",
      "question": "Tell me about your previous pregnancies, if any.",
      "follow_ups": [
        "Any pregnancy losses?",
        "Children with health conditions or developmental issues?",
        "Abnormal prenatal test results in past?",
        "Stillbirths or infant deaths?"
      ],
      "clinical_focus": ["obstetric_history", "previous_genetic_issues", "pregnancy_outcomes"]
    },
    {
      "id": 5,
      "section": "current_pregnancy_testing",
      "question": "What prenatal testing have you had or are you considering?",
      "follow_ups": [
        "First trimester screening (NT scan, blood tests)?",
        "Cell-free DNA testing (NIPT)?",
        "Amniocentesis or CVS?",
        "Anatomy ultrasound findings?"
      ],
      "clinical_focus": ["screening_tests", "diagnostic_tests", "test_results"]
    },
    {
      "id": 6,
      "section": "understanding_of_testing",
      "question": "What is your understanding of the different genetic tests available?",
      "follow_ups": [
        "Difference between screening and diagnostic tests?",
        "What conditions are being tested for?",
        "Limitations and accuracy of tests?",
        "What happens if results are positive?"
      ],
      "clinical_focus": ["health_literacy", "test_comprehension", "informed_decision_making"]
    },
    {
      "id": 7,
      "section": "decision_making",
      "question": "How are you thinking about which tests to have, if any?",
      "follow_ups": [
        "What factors are most important to you?",
        "How would you use the information from testing?",
        "Discussed with partner/family?",
        "Religious or personal beliefs influencing decision?"
      ],
      "clinical_focus": ["decision_making_process", "values", "partner_involvement", "belief_systems"]
    },
    {
      "id": 8,
      "section": "advanced_maternal_age",
      "question": "If applicable: How do you feel about the genetic risks related to your age?",
      "follow_ups": [
        "Understanding of age-related risks?",
        "Concerns about chromosomal abnormalities?",
        "How is age factoring into your testing decisions?"
      ],
      "clinical_focus": ["maternal_age", "age_related_risks", "risk_perception"],
      "conditional": "age >= 35"
    },
    {
      "id": 9,
      "section": "anxiety_and_coping",
      "question": "How are you feeling emotionally about genetic testing and possible results?",
      "follow_ups": [
        "Anxiety about testing or results?",
        "How would you cope with concerning results?",
        "Support system for decision-making?",
        "Previous experience with genetic testing?"
      ],
      "clinical_focus": ["anxiety", "coping_mechanisms", "emotional_support", "psychological_preparation"]
    },
    {
      "id": 10,
      "section": "information_needs",
      "question": "What additional information would be helpful for you?",
      "follow_ups": [
        "Questions about specific conditions?",
        "Need for more detailed risk assessment?",
        "Resources for learning more?",
        "Follow-up counseling needed?",
        "Is there anything else you'd like to discuss?"
      ],
      "clinical_focus": ["information_gaps", "education_needs", "follow_up_planning", "patient_questions"],
      "closing": true
    }
  ],
  "ethical_considerations": [
    "Ensure non-directive counseling approach",
    "Respect patient autonomy in decision-making",
    "Cultural sensitivity regarding genetic testing",
    "Privacy and confidentiality of genetic information",
    "Psychological impact of testing and results"
  ],
  "metadata": {
    "created_date": "2025-01-15",
    "created_by": "Claude Code - Gravidas v1.2.0",
    "validated_by": null,
    "clinical_review_status": "pending",
    "requires_genetic_counselor_review": true
  }
}
```

##### Step 2.1.6: Update Interview Script to Handle Multiple Protocols
**File:** `scripts/04_conduct_interviews.py`

**Claude Code Instructions:**
1. Add protocol selection functionality:

```python
def load_interview_protocol(protocol_name: str) -> Dict[str, Any]:
    """
    Load interview protocol by name.

    Args:
        protocol_name: Name of protocol (e.g., 'prenatal_care', 'postpartum_care')

    Returns:
        Protocol dictionary

    Raises:
        FileNotFoundError: If protocol doesn't exist
    """
    protocol_file = Path(f'Script/interview_protocols/{protocol_name}.json')

    if not protocol_file.exists():
        available = list(Path('Script/interview_protocols').glob('*.json'))
        available_names = [p.stem for p in available]
        raise FileNotFoundError(
            f"Protocol '{protocol_name}' not found. Available protocols: {', '.join(available_names)}"
        )

    with open(protocol_file, 'r') as f:
        return json.load(f)


def list_available_protocols() -> List[str]:
    """List all available interview protocols."""
    protocol_dir = Path('Script/interview_protocols')
    return [p.stem for p in protocol_dir.glob('*.json')]
```

2. Add CLI argument for protocol selection:

```python
parser.add_argument(
    '--protocol',
    type=str,
    default='prenatal_care',
    help='Interview protocol to use (e.g., prenatal_care, postpartum_care, high_risk_pregnancy)'
)
```

3. Validate protocol exists before starting interviews:

```python
# In main():
available_protocols = list_available_protocols()
if args.protocol not in available_protocols:
    logger.error(f"Protocol '{args.protocol}' not found.")
    logger.info(f"Available protocols: {', '.join(available_protocols)}")
    sys.exit(1)

logger.info(f"Using protocol: {args.protocol}")
protocol = load_interview_protocol(args.protocol)
```

##### Step 2.1.7: Add Protocol Selection in Interactive Mode
**File:** `scripts/interactive_interviews.py`

**Claude Code Instructions:**
Add menu option for protocol selection:

```python
def select_protocol() -> str:
    """Interactive protocol selection."""
    protocols = list_available_protocols()

    print("\n=== Interview Protocol Selection ===\n")
    print("Available protocols:")

    for idx, protocol_name in enumerate(protocols, 1):
        # Load protocol to get description
        protocol = load_interview_protocol(protocol_name)
        description = protocol.get('description', 'No description')
        target = protocol.get('target_population', 'General')

        print(f"{idx}. {protocol_name}")
        print(f"   {description}")
        print(f"   Target: {target}\n")

    while True:
        choice = input(f"Select protocol (1-{len(protocols)}) [1]: ").strip()

        if not choice:
            return protocols[0]  # Default to first

        try:
            idx = int(choice) - 1
            if 0 <= idx < len(protocols):
                return protocols[idx]
        except ValueError:
            pass

        print("Invalid choice. Please try again.")
```

##### Step 2.1.8: Validate Each Protocol with Test Interviews
**Claude Code Instructions:**
Create validation script:

```python
#!/usr/bin/env python3
"""
Validate all interview protocols by running test interviews.

This script:
1. Runs 5 test interviews for each protocol
2. Validates protocol structure and question flow
3. Checks for missing fields or errors
4. Generates protocol validation report
"""

import json
from pathlib import Path
import logging

logger = logging.getLogger(__name__)

def validate_protocol_structure(protocol: Dict[str, Any]) -> List[str]:
    """Validate protocol has required fields."""
    required_fields = [
        'protocol_name',
        'description',
        'target_population',
        'questions'
    ]

    errors = []

    for field in required_fields:
        if field not in protocol:
            errors.append(f"Missing required field: {field}")

    # Validate questions
    if 'questions' in protocol:
        for idx, question in enumerate(protocol['questions'], 1):
            if 'question' not in question:
                errors.append(f"Question {idx} missing 'question' field")
            if 'clinical_focus' not in question:
                errors.append(f"Question {idx} missing 'clinical_focus' field")

    return errors


def run_test_interview_for_protocol(protocol_name: str) -> bool:
    """Run a single test interview for a protocol."""
    try:
        # Use mocked AI or actual API
        # ... implementation ...
        return True
    except Exception as e:
        logger.error(f"Test interview failed for {protocol_name}: {e}")
        return False


def main():
    protocols = list_available_protocols()

    print(f"\n=== Protocol Validation ===")
    print(f"Found {len(protocols)} protocols\n")

    validation_results = {}

    for protocol_name in protocols:
        print(f"Validating {protocol_name}...")

        # Load protocol
        protocol = load_interview_protocol(protocol_name)

        # Validate structure
        structure_errors = validate_protocol_structure(protocol)

        # Run test interviews
        test_success = run_test_interview_for_protocol(protocol_name)

        validation_results[protocol_name] = {
            'structure_valid': len(structure_errors) == 0,
            'structure_errors': structure_errors,
            'test_interview_success': test_success
        }

        if len(structure_errors) == 0 and test_success:
            print(f"  âœ“ {protocol_name} validated successfully")
        else:
            print(f"  âœ— {protocol_name} validation failed")
            if structure_errors:
                for error in structure_errors:
                    print(f"    - {error}")

    # Generate report
    report_file = Path('logs/protocol_validation_report.json')
    with open(report_file, 'w') as f:
        json.dump(validation_results, f, indent=2)

    print(f"\nValidation report saved to {report_file}")


if __name__ == '__main__':
    main()
```

Run validation:
```bash
python scripts/validate_protocols.py
```

#### Testing Instructions (Claude Code)
```bash
# Test each protocol with 5 interviews
for protocol in prenatal_care postpartum_care high_risk_pregnancy perinatal_mental_health genetic_counseling
do
  echo "Testing protocol: $protocol"
  python scripts/04_conduct_interviews.py --protocol $protocol --count 5
done

# Analyze results
python scripts/analyze_interviews.py --by-protocol

# Validate all protocols
python scripts/validate_protocols.py
```

#### Human Offline Tasks
- [ ] **Clinical Review** - Have domain experts (OB/GYN, genetic counselor, mental health professional) review protocols for clinical accuracy
- [ ] **Validate Questions** - Ensure questions are appropriate for target populations
- [ ] **Ethics Review** - Especially for mental health protocol (crisis responses, sensitivity)
- [ ] **Pilot Testing** - Manually review 2-3 interviews from each protocol for quality
- [ ] **Documentation** - Document when to use each protocol

#### Acceptance Criteria
- [x] 5 protocols created and validated
- [x] Each protocol has 10-18 questions
- [x] Protocol-specific documentation complete
- [x] CLI and interactive mode support protocol selection
- [x] 5 test interviews successful for each protocol
- [x] Clinical review status documented

**Deliverable:** `Script/interview_protocols/` with 5 validated, clinically-appropriate protocols

---

### 2.2 Persona Name Extraction ðŸŸ¢ P2 LOW

**Current State:** All interviews show "Unknown" persona name
**Target State:** 90%+ interviews have names
**Priority:** P2 (User Experience)
**Effort:** 8 hours

#### Implementation Steps (Claude Code)

##### Step 2.2.1: Parse First Name from Persona Description
**File:** `scripts/01b_generate_personas.py`

**Claude Code Instructions:**
1. Extract name when generating persona:

```python
def extract_name_from_description(description: str) -> Optional[str]:
    """
    Extract first name from persona description.

    Examples:
    - "Sarah is a 30-year-old..." â†’ "Sarah"
    - "Maria, a software engineer..." â†’ "Maria"
    - "Dr. Jennifer Smith works as..." â†’ "Jennifer"
    """
    import re

    # Pattern: Name at start of description
    # Matches: "Sarah is", "Maria, a", "Dr. Jennifer"
    patterns = [
        r'^([A-Z][a-z]+)\s+is\s+',  # "Sarah is"
        r'^([A-Z][a-z]+),\s+',       # "Maria, a"
        r'^Dr\.\s+([A-Z][a-z]+)',    # "Dr. Jennifer"
        r'^([A-Z][a-z]+)\s+[A-Z]',   # "Sarah Smith" (first name before last)
    ]

    for pattern in patterns:
        match = re.search(pattern, description)
        if match:
            return match.group(1)

    # Fallback: first capitalized word
    words = description.split()
    for word in words:
        if word[0].isupper() and word.isalpha():
            return word

    return None


# In persona generation:
persona_description = response['description']
persona_name = extract_name_from_description(persona_description)

persona_data = {
    'persona_id': persona_id,
    'name': persona_name,  # Add this field
    'description': persona_description,
    # ... other fields ...
}
```

##### Step 2.2.2: Add Name Generation Fallback
**Claude Code Instructions:**
When description doesn't contain a name, generate one based on demographics:

```python
import random

# Diverse name lists
FEMALE_NAMES_BY_ETHNICITY = {
    'hispanic': ['Maria', 'Sofia', 'Isabella', 'Valentina', 'Camila', 'Elena', 'Ana', 'Rosa'],
    'black': ['Aaliyah', 'Nia', 'Zuri', 'Amara', 'Keisha', 'Tamika', 'Imani', 'Jada'],
    'white': ['Sarah', 'Emily', 'Jennifer', 'Jessica', 'Ashley', 'Emma', 'Olivia', 'Ava'],
    'asian': ['Yuki', 'Mei', 'Priya', 'Linh', 'Min', 'Sakura', 'Ananya', 'Ji-woo'],
    'default': ['Alex', 'Jordan', 'Sam', 'Taylor', 'Morgan', 'Casey', 'Riley', 'Quinn']
}

def generate_name_fallback(persona: Dict[str, Any]) -> str:
    """
    Generate appropriate name based on persona demographics.

    Args:
        persona: Persona dictionary with ethnicity field

    Returns:
        Generated first name
    """
    ethnicity = persona.get('ethnicity', 'default').lower()

    # Map ethnicity to name list
    if 'hispanic' in ethnicity or 'latina' in ethnicity:
        names = FEMALE_NAMES_BY_ETHNICITY['hispanic']
    elif 'black' in ethnicity or 'african' in ethnicity:
        names = FEMALE_NAMES_BY_ETHNICITY['black']
    elif 'white' in ethnicity or 'caucasian' in ethnicity:
        names = FEMALE_NAMES_BY_ETHNICITY['white']
    elif 'asian' in ethnicity or 'pacific' in ethnicity:
        names = FEMALE_NAMES_BY_ETHNICITY['asian']
    else:
        names = FEMALE_NAMES_BY_ETHNICITY['default']

    return random.choice(names)


# Usage:
persona_name = extract_name_from_description(description)
if not persona_name:
    persona_name = generate_name_fallback(persona_data)
    logger.info(f"Generated fallback name: {persona_name}")
```

##### Step 2.2.3: Populate persona_name Field in Output CSV
**File:** `scripts/analyze_interviews.py`

**Claude Code Instructions:**
Ensure persona_name is included in CSV export:

```python
# In CSV writing code:
csv_headers = [
    'persona_id',
    'persona_name',  # Add this
    'persona_age',
    'education',
    # ... other fields
]

# Extract from matched persona data:
persona_name = matched_persona.get('name', 'Unknown')

csv_row = {
    'persona_id': persona_id,
    'persona_name': persona_name,
    # ... other data
}
```

##### Step 2.2.4: Update Interview Transcripts to Use Names
**File:** `scripts/04_conduct_interviews.py`

**Claude Code Instructions:**
Use actual names in interview transcripts:

```python
# When constructing interview prompt:
persona_name = matched_pair['persona'].get('name', 'Unknown')

interview_prompt = f"""
You are conducting an interview with {persona_name}, a {age}-year-old {occupation}.

{persona_name}'s background:
{persona_description}

Please conduct a natural, empathetic interview following the protocol questions.
Address them as {persona_name} throughout the conversation.
"""

# In transcript:
transcript.append({
    'speaker': 'interviewer',
    'text': f"Thank you for joining me today, {persona_name}. How are you feeling?"
})
```

#### Testing Instructions (Claude Code)
Create test to verify name extraction:

```python
def test_name_extraction():
    """Test name extraction from various description formats."""

    test_cases = [
        ("Sarah is a 30-year-old engineer", "Sarah"),
        ("Maria, a software developer from Boston", "Maria"),
        ("Dr. Jennifer Smith works as a physician", "Jennifer"),
        ("Elena Rodriguez is expecting her first child", "Elena"),
    ]

    for description, expected_name in test_cases:
        extracted = extract_name_from_description(description)
        assert extracted == expected_name, f"Expected {expected_name}, got {extracted}"

    print("âœ“ All name extraction tests passed")
```

Run test:
```bash
pytest tests/test_persona_names.py -v
```

#### Human Offline Tasks
- [ ] **Review name diversity** - Ensure generated names are culturally appropriate
- [ ] **Validate name extraction** - Check 20-30 personas manually
- [ ] **Update documentation** - Document name extraction logic

#### Acceptance Criteria
- [x] â‰¥90% of interviews have persona names (not "Unknown")
- [x] Names culturally appropriate for persona demographics
- [x] Graceful fallback for missing names
- [x] Names used consistently in interview transcripts

**Deliverable:** Enhanced persona parser with name extraction and fallback generation

---

### 2.3 Enhanced Cost Tracking ðŸŸ¡ P2 MEDIUM

**Current State:** Approximate token counting with estimated costs
**Target State:** Exact API cost tracking with real-time monitoring
**Priority:** P2 (Financial Analysis)
**Effort:** 15 hours

*(Implementation details continue...)*

---

## Phase 3: Documentation & Reproducibility (Weeks 9-10)

*(Details continue...)*

---

## Phase 4: Final Validation & Launch (Weeks 11-12)

*(Details continue...)*

---

*This guide continues in the main implementation document. The sections above provide detailed, step-by-step instructions for Claude Code to implement each feature with clear testing procedures and human offline task separation.*

**Next Steps:**
1. Read and understand Phase 1 tasks
2. Begin with Task 1.1 (Semantic Tree Fixes)
3. Follow testing instructions precisely
4. Document all findings

